  
# Seminar M2L13: Другие особенности веб сервера   (14.06.24)

## Валидация

- Zod, Yup, joi 
- Json schema (ajv) - валидация через json schema
- class-validator - пишем классы, используем валидацию с помощью декораторов

Из минусов json schema ограничены возможности валидации





### Что мы валидируем в REST:
- Query params
- Path values (шаблоны путм)
- Request Body 
- Headers 

### Query params
Параметры, передаваемые в URL после знака `{}`
Передать массив можно с помощью separator symbol `?values=1,2,3` и уже получив string sequence сделать split (`values = params.values.split(',')`)
Еще можно использовать параметр с одинаковым именем для каждого элемента массива
`?values=1&values=2&values=3` и еще дополнительно можно использовать квадратные скобки
`?values[]=1&values[]=2&values[]=3`

### Order of Validation

Валидация на уровне **Middleware** подходит для остановки запросов раньше, еще до того, как они попадут в контроллер, с очевидным минусом в виде замедления запросов, поскольку каждый запрос должен пройти через один или несколько **middleware**, прежде чем попасть в нужное место.
Для валидации на уровне middleware:
- express-validation
- celebrete (new)
- кастомный валидатор
- class-validator

Уровень **Controller / Service** хорош, когда вы хотите объединить несколько сервисов для обработки информации, но делегирует проверку на второй шаг для вещей, которые уже могли быть сделаны **middleware**.

## Загрузка файлов

Можно использовать спец. библиотеки для этого:

[Multer](https://www.npmjs.com/package/multer) - middleware для обработки multipart/form-data

